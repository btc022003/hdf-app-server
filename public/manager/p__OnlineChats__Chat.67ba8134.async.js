(self.webpackChunkhdf_app_manager=self.webpackChunkhdf_app_manager||[]).push([[819],{49849:function($,M,t){"use strict";t.r(M);var J=t(24793),C=t(97183),N=t(13062),B=t(71230),H=t(57663),p=t(71577),V=t(47673),L=t(4107),z=t(89032),f=t(15746),y=t(86582),G=t(9715),u=t(93766),l=t(2824),d=t(67294),I=t(48733),U=t(5977),e=t(85893);function A(){var c,E,T=(0,U.TH)(),x=T.search,R=new URLSearchParams(x),a=R.get("d_id"),s=(0,d.useRef)(null),K=(0,d.useState)([]),D=(0,l.Z)(K,2),m=D[0],v=D[1],W=(0,d.useState)(""),O=(0,l.Z)(W,2),i=O[0],j=O[1],F=u.Z.useForm(),Z=(0,l.Z)(F,1),P=Z[0];return(0,d.useEffect)(function(){s.current=(0,I.io)("http://localhost:3000",{query:{id:a,type:"d"}}),s.current.on("connect",function(){var n;console.log("\u8FDE\u63A5\u6210\u529F"),(n=s.current)===null||n===void 0||n.emit("to_work",{doctor:a})}),s.current.on("ask",function(n){v(function(_){var r=_.findIndex(function(o){return o.id==n.user});return r<0?[].concat((0,y.Z)(_),[{id:n.user,name:n.from,list:[{type:"a",content:n.content,id:Date.now()*9999+998*Math.random()}]}]):(_[r].list.push({type:"a",content:n.content,id:Date.now()*9999+998*Math.random()}),JSON.parse(JSON.stringify(_)))})})},[]),a?(0,e.jsx)(C.Z.Content,{children:(0,e.jsxs)(B.Z,{children:[(0,e.jsx)(f.Z,{span:4,children:m.map(function(n){return(0,e.jsx)("h1",{onClick:function(){j(n.id)},children:n.name},n.id)})}),(0,e.jsxs)(f.Z,{span:20,children:[(c=m.find(function(n){return n.id==i}))===null||c===void 0?void 0:c.list.map(function(n){return(0,e.jsxs)("p",{children:[(0,e.jsx)("span",{children:n.type=="a"?"\u95EE":"\u7B54"}),":",n.content]},n.id)}),(0,e.jsx)("h1",{children:(E=m.find(function(n){return n.id==i}))===null||E===void 0?void 0:E.list.length}),(0,e.jsxs)(u.Z,{form:P,onFinish:function(_){var r;v(function(o){var h,g=o.findIndex(function(S){return S.id==i});return(h=o[g])===null||h===void 0||h.list.push({type:"r",content:_.content,id:Date.now()*9999+998*Math.random()}),JSON.parse(JSON.stringify(o))}),(r=s.current)===null||r===void 0||r.emit("reply",{user:i,doctor:a,content:_.content}),P.setFieldsValue({content:""})},children:[(0,e.jsx)(u.Z.Item,{name:"content",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56DE\u590D\u5185\u5BB9"}],children:(0,e.jsx)(L.Z,{type:"text",placeholder:"\u8BF7\u8F93\u5165\u56DE\u590D\u7684\u5185\u5BB9"})}),(0,e.jsx)(u.Z.Item,{children:(0,e.jsx)(p.Z,{type:"primary",htmlType:"submit",children:"\u56DE\u590D"})})]})]})]})}):(0,e.jsx)(e.Fragment,{children:"\u8BF7\u4ECE\u533B\u751F\u5217\u8868\u91CD\u65B0\u70B9\u51FB\u4E0A\u7EBF"})}M.default=A}}]);
